<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="website icon" type="png" href="lb.png" >  <!-- show website icon -->
    <!-- Font Awesome Icon Library, usage for ratting function -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Education Website</title>
    <style>
        body {
            background-color: #2c0b44; 
            color: #FFF; /* White font */
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .container {
            margin-top: 20px;
        }
        .row {
            display: flex;
            justify-content: left;
            margin-bottom: 50px; 
            flex-wrap: wrap; 
        }
        .row h2 {
            text-align: left;
            width: 100%; 
            margin-bottom: 10px; 
        }
        .image-container {
            margin: 10px;
        }
        .image-container img {
            width: 200px;
            height: 200px;
            border-radius: 10px;
            cursor: pointer;
        }
        .image-text {
            color: #FFF; /* White font color */
            font-size: 20px;
            margin-top: 10px;
        }
        /* Display userid on the right corner */
        .user-id {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #FFF;
            font-size: 18px;
        }
        .logout-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #ffdb98;
            color: rgb(0, 34, 70);
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .logout-button:hover {
            background-color: #e77171;
        }
        .rating-button {
            position: fixed;
            bottom: 20px;
            right: 115px;
            background-color: #6ac66f;
            color: rgb(0, 34, 70);
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .rating-button:hover {
            background-color: #0d450f;
        }
        /* Modal box for feedback */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Fixed position */
            z-index: 1; /* On top of everything else */
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; /* Enable scroll */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black with opacity */
        }
        .modal-content {
            background-color: #2c0b44;
            margin: 15% auto; /* 15% from top, centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        /* Star rating styles */
        .stars {
            display: flex;
            justify-content: center;
        }
        .fa-star {
            font-size: 36px;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .fa-star:hover {
            color: orange;
        }
        .checked { 
            color: orange;
        }
        .feedback-message {
            color: #FFF;
            margin-top: 20px;
            font-size: 18px;
        }
        .rating-message {
            color: rgb(161, 124, 45);
            margin-top: 20px;
            font-size: 18px;
        }
        .submitFeedback-button {
            position: center;
            margin-top: 20px;
            background-color: #bebdef;
            color: rgb(1, 18, 37);
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .submitFeedback-button:hover {
            background-color: #1d60be;
        }
    </style>
</head>
<body>
    <h1>Education Website</h1>
    <div class="user-id">{{ userid }}</div>  <!-- show userid (username) on the top right side -->
    <div class="container">  <!-- List of menu components (image, description, redirect) -->
        <!-- Row 1: Questionnaires -->
        <div class="row">
            <h2>Questionnaires</h2>
            <div class="image-container">
                <a href="Vietnam_Questionnaire.html">
                    <img src="Questionnaire/vn.jpeg" alt="Vietnam Questionnaire">
                    <div class="image-text">Vietnam Questionnaire</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Australia_Questionnaire.html">
                    <img src="Questionnaire/au.jpeg" alt="Australia Questionnaire">
                    <div class="image-text">Australia Questionnaire</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Math.html">
                    <img src="Questionnaire/math.jpeg" alt="Math Questionnaire">
                    <div class="image-text">Math Questionnaire</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Physics.html">
                    <img src="Questionnaire/phy.jpeg" alt="Physics Questionnaire">
                    <div class="image-text">Physics Questionnaire</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Country_Guess.html">
                    <img src="Questionnaire/world.jpeg" alt="Guessing Flags">
                    <div class="image-text">Guessing Flags</div>
                </a>
            </div>
        </div>
        <!-- Row 2: Classrooms -->
        <div class="row">
            <h2>Classrooms</h2>
            <div class="image-container">
                <a href="Math_Formula.html">
                    <img src="Classroom/math_formula.jpeg" alt="Math Formulas">
                    <div class="image-text">Math Formulas</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Chemistry_Concept.html">
                    <img src="Classroom/chemistry_concept.webp" alt="Chemistry Concepts">
                    <div class="image-text">Chemistry Concepts</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Physics_Concept.html">
                    <img src="Classroom/physics_concept.jpeg" alt="Physics Concepts">
                    <div class="image-text">Physics Concepts</div>
                </a>
            </div>
            <div class="image-container">
                <a href="flag_answer.html">
                    <img src="Classroom/explore_flags.jpeg" alt="Explore Flags">
                    <div class="image-text">Explore Flags</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Update/index.html">
                    <img src="Classroom/contribution.png" alt="Knowledge Contribution">
                    <div class="image-text">Knowledge Contribution</div>
                </a>
            </div>
        </div>
        <!-- Row 3: Social Media -->
        <div class="row">
            <h2>Social Media</h2>
            <div class="image-container">
                <a href="Social_Feedback.html">
                    <img src="Social_Media/social.jpeg" alt="Social Feedback">
                    <div class="image-text">Social Feedback</div>
                </a>
            </div>
            <div class="image-container">
                <a href="Social_Forum.html">
                    <img src="Social_Media/forum.jpeg" alt="Social Forum">
                    <div class="image-text">Social Forum</div>
                </a>
            </div>
        </div>
    </div>
    <button class="logout-button" onclick="logout()">Log Out</button>
    <button class="rating-button" onclick="openRatingModal()">Rate Us</button>

    <!-- Rating content, references from https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_star_rating -->
    <!-- Modal box, references from https://www.w3schools.com/howto/howto_css_modals.asp -->
    <div id="ratingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRatingModal()">&times;</span>  <!-- close modal box upon clicking to x -->
            <h2>Rate Our Website</h2>
            <div class="stars">  <!-- display star and set mouseover position on star -->
                <span class="fa fa-star" onmouseover="toggleStars(1)"></span>
                <span class="fa fa-star" onmouseover="toggleStars(2)"></span>
                <span class="fa fa-star" onmouseover="toggleStars(3)"></span>
                <span class="fa fa-star" onmouseover="toggleStars(4)"></span>
                <span class="fa fa-star" onmouseover="toggleStars(5)"></span>
            </div>
            <button class="submitFeedback-button" onclick="acquireFeedback()">Submit Feedback</button>
            <div id="feedbackMessage" class="feedback-message"></div>
            <div id="feedbackRating" class="rating-message"></div>
        </div>
    </div>

    <script>
        const userid = localStorage.getItem('userid'); // Extract userid (username) component saved temporarily 
        document.querySelector('.user-id').textContent = '@' + userid; // userid shown after @ symbol

        function logout() {
            localStorage.removeItem('users'); // Remove all users data in local storage, please commend this line, only for testing purpose.
            // Remove the temporary - current logged in user info per log out
            localStorage.removeItem('userid'); 
            localStorage.removeItem('useremail'); 
            localStorage.removeItem('userpassword');
            window.location.href = 'Credential.html';
        }

        // Function to open the rating modal
        function openRatingModal() {
            document.getElementById('ratingModal').style.display = 'block';
        }

        // Function to close the rating modal
        function closeRatingModal() {
            document.getElementById('ratingModal').style.display = 'none';
        }

        // Function to send message accquiring feedback
        function acquireFeedback() {
            const stars = document.querySelectorAll('.fa-star.checked').length; // Checking number of star acquired, therefore set feedback message upon ratting type
            const feedbackMessage = document.getElementById('feedbackMessage');
            if (stars >= 3) {
                feedbackMessage.textContent = "Thank you, we are happy with your " + stars + " stars feedback!";
            } else {
                feedbackMessage.textContent = "Thank you for your " + stars + " stars feedback, you can leave a comment in Social Feedback page to improve us.";
            }
            obtainFeedback();
        }

        // Function to saved ratting type per attempt and send message obtaining feedback count (with increment)
        function obtainFeedback() {
            const stars = document.querySelectorAll('.fa-star.checked').length;
            // Array to store counts for each star rating, reference from https://www.geeksforgeeks.org/what-is-the-most-efficient-way-to-create-a-zero-filled-array-in-javascript/
            // Get current website ratings from localStorage
            let websiteRatings = JSON.parse(localStorage.getItem('website_ratings')) || [0, 0, 0, 0, 0];
            // Increment the count for the selected star rating
            websiteRatings[stars - 1]++;
            // Update website ratings in localStorage
            localStorage.setItem('website_ratings', JSON.stringify(websiteRatings));

            // Display the feedback counts
            const feedbackRating = document.getElementById('feedbackRating');
            feedbackRating.innerHTML = `
                Number of 5 stars rating: ${websiteRatings[4]}<br>
                Number of 4 stars rating: ${websiteRatings[3]}<br>
                Number of 3 stars rating: ${websiteRatings[2]}<br>
                Number of 2 stars rating: ${websiteRatings[1]}<br>
                Number of 1 stars rating: ${websiteRatings[0]}<br>
            `;
        }

        // Function to handle rating
        function rate(stars) {
            // Close the modal after rating
            closeRatingModal();
        }

         // Function to toggle star colors based on mouseover
         function toggleStars(num) {
            const stars = document.querySelectorAll('.fa-star');
            for (let i = 0; i < stars.length; i++) { // Per mouseover, it set all star to the left toggled
                if (i < num) {
                    stars[i].classList.add('checked');
                } else {
                    stars[i].classList.remove('checked');
                }
            }
        }
    </script>
</body>
</html>
